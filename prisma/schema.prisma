// schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ScrapingProvider {
  EPROCURE
  GEM
  CPP_PORTAL
  CUSTOM
}

enum SessionStatus {
  RUNNING
  COMPLETED
  FAILED
  STOPPED
  PAUSED
}

model ScrapingSession {
  id                      String           @id
  
  // Basic session info
  name                    String?
  description             String?
  provider                ScrapingProvider
  baseUrl                 String
  status                  SessionStatus
  
  // Progress tracking
  progress                Float            @default(0)
  
  // Statistics
  organizationsFound      Int              @default(0)
  organizationsScraped    Int              @default(0)
  tendersFound            Int              @default(0)
  tenderScraped           Int              @default(0)
  tendersSaved            Int              @default(0)
  pagesNavigated          Int              @default(0)
  pagesPerMinute          Float            @default(0)
  avgResponseTime         Float            @default(0)
  
  // Current activity tracking
  currentOrganization     String?
  currentStage            String?
  
  // Timestamps
  startedAt               DateTime
  completedAt             DateTime?
  lastActivityAt          DateTime
  
  // Error information (for failed sessions)
  errorMessage            String?
  
  // Metadata
  createdAt               DateTime         @default(now())
  updatedAt               DateTime         @updatedAt
  
  @@index([provider])
  @@index([status])
  @@index([startedAt])
  @@index([lastActivityAt])
}